-- Tabla de usuarios para el login (RF2)
CREATE TABLE IF NOT EXISTS usuarios (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    username TEXT NOT NULL UNIQUE,
    password TEXT NOT NULL    -- para el proyecto usamos texto plano (simple)
);

INSERT INTO usuarios (username, password)
VALUES ('admin', '1234');

-- Tabla de órdenes de compra (RF1)
CREATE TABLE IF NOT EXISTS ordenes_compra (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    numero_orden TEXT NOT NULL,
    cliente TEXT NOT NULL,
    direccion TEXT NOT NULL,
    telefono TEXT NOT NULL,
    comuna TEXT NOT NULL,
    region TEXT NOT NULL,
    producto TEXT NOT NULL,
    cantidad INTEGER NOT NULL,
    precio_unitario REAL NOT NULL,
    estado TEXT NOT NULL DEFAULT 'PENDIENTE'  -- PENDIENTE / FACTURADA / DESPACHADA
);

-- Tabla de facturas (RF4)
CREATE TABLE IF NOT EXISTS facturas (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    orden_id INTEGER NOT NULL,
    subtotal REAL NOT NULL,
    iva REAL NOT NULL,
    total REAL NOT NULL,
    fecha TEXT NOT NULL,
    estado TEXT NOT NULL DEFAULT 'EMITIDA',   -- EMITIDA / ENVIADA
    FOREIGN KEY (orden_id) REFERENCES ordenes_compra(id)
);

-- Tabla de envíos (RF5)
CREATE TABLE IF NOT EXISTS envios (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    factura_id INTEGER NOT NULL,
    fecha_envio TEXT NOT NULL,
    estado_envio TEXT NOT NULL,               -- DESPACHADO / PENDIENTE
    observacion TEXT,
    FOREIGN KEY (factura_id) REFERENCES facturas(id)
);
